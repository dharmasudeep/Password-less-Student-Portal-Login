{% extends "base.html" %}
{% block title %}Chat · Password-less{% endblock %}
{% block content %}
<section class="chat-layout" aria-label="Conversation">
    <header class="chat-header">
        <h1>Assistant</h1>
        <div class="chat-controls">
            <button id="stream-toggle" class="btn secondary" type="button" aria-pressed="false">Streaming: Off</button>
            <button id="clear-chat" class="btn" type="button">Clear conversation</button>
        </div>
    </header>
    <div id="chat-log" class="chat-log" role="log" aria-live="polite" aria-relevant="additions">
        {% for message in messages %}
            <div class="chat-message {{ message.role }}">
                <div class="bubble">
                    <span class="role-label">{{ message.role|capitalize }}</span>
                    <p>{{ message.content }}</p>
                    <time datetime="{{ message.created_at.isoformat() }}">{{ message.created_at.strftime('%H:%M') }}</time>
                </div>
            </div>
        {% endfor %}
    </div>
    <div id="typing-indicator" class="typing" hidden aria-live="assertive">Assistant is typing…</div>
    <form id="chat-form" class="chat-composer" autocomplete="off">
        <label for="message" class="sr-only">Your message</label>
        <textarea id="message" name="message" rows="2" placeholder="Ask me anything" required></textarea>
        <button class="btn primary" type="submit">Send</button>
    </form>
</section>
{% endblock %}
{% block scripts %}
<script type="module" src="{{ url_for('static', filename='js/chat.js') }}"></script>
{% endblock %}
